{"ast":null,"code":"/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict'; // Modified from https://github.com/ArthurClemens/Javascript-Undo-Manager\n// Copyright (c) 2010-2013 Arthur Clemens, arthur@visiblearea.com\n\nmodule.exports = function UndoManager() {\n  var undoCommands = [];\n  var index = -1;\n  var isExecuting = false;\n  var callback;\n\n  function execute(command, action) {\n    if (!command) return this;\n    isExecuting = true;\n    command[action]();\n    isExecuting = false;\n    return this;\n  }\n\n  return {\n    add: function add(command) {\n      if (isExecuting) return this;\n      undoCommands.splice(index + 1, undoCommands.length - index);\n      undoCommands.push(command);\n      index = undoCommands.length - 1;\n      return this;\n    },\n    setCallback: function setCallback(callbackFunc) {\n      callback = callbackFunc;\n    },\n    undo: function undo() {\n      var command = undoCommands[index];\n      if (!command) return this;\n      execute(command, 'undo');\n      index -= 1;\n      if (callback) callback(command.undo);\n      return this;\n    },\n    redo: function redo() {\n      var command = undoCommands[index + 1];\n      if (!command) return this;\n      execute(command, 'redo');\n      index += 1;\n      if (callback) callback(command.redo);\n      return this;\n    },\n    clear: function clear() {\n      undoCommands = [];\n      index = -1;\n    },\n    hasUndo: function hasUndo() {\n      return index !== -1;\n    },\n    hasRedo: function hasRedo() {\n      return index < undoCommands.length - 1;\n    },\n    getCommands: function getCommands() {\n      return undoCommands;\n    },\n    getPreviousCommand: function getPreviousCommand() {\n      return undoCommands[index - 1];\n    },\n    getIndex: function getIndex() {\n      return index;\n    }\n  };\n};","map":null,"metadata":{},"sourceType":"script"}